--flashlight initialization
local fl = game.ReplicatedStorage:waitforchild("Tools").Flashlight:Clone()
fl.parent = game.replicatedstorage.Tools.UsedLights

--player initialization

local players, loading = game.Players:GetPlayers(), game.ReplicatedStorage.Events.loadingScreen
for i in ipairs(players:GetChildren()) do
    local plr = i:GetPlayerFromCharacter()
    plr.character:waitforchild("Humanoid").WalkSpeed = 0
    loading:FireClient(plr)
end

local loadingResponse = game.ReplicatedStorage.Events.loadingResponse
local responsePlayers = {}

while #responsePlayers ~= #players do
    for i in ipairs(players:GetChildren()) do
        local plr = i:GetPlayerFromCharacter()
        local finishVal = plr.BackPack.Vals.finishedVal
        local plrFind = table.find(responsePlayers, plr)
            
        if finishVal and ~plrFind then
            table.add(responsePlayers, plr)
        end
    end
    wait(1)
    game.Players.PlayerRemoving:Connect(function(plr)
        local plrFind = table.find(players, plr)
        if plrFind then
            table.remove(players, plr)
        end
    end)
end
loadingResponse:FireAllClients()


--seeker initialization
local seeker = players[math.random(1, #players)]
FLSanity.FLAdd(seeker)

--[[ Loading finished
announce who seeker is in GUI

begin game start countdown
]]
